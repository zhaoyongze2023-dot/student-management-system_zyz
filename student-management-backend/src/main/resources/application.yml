spring:
  application:
    name: student-management-backend
  
  # Nacos 配置（服务注册发现 + 配置管理）
  cloud:
    nacos:
      server-addr: localhost:8848  # Nacos 服务器地址
      discovery:
        enabled: true
        group: DEFAULT_GROUP
        namespace: public
        register-enabled: true
      config:
        enabled: true
        group: DEFAULT_GROUP
        namespace: public
        file-extension: yaml
        auto-refresh: true
        # 从 Nacos 导入配置文件
        import-check:
          enabled: true
  
  config:
    import:
      - optional:nacos:database-config.yml?group=DEFAULT_GROUP
      - optional:nacos:redis-config.yml?group=DEFAULT_GROUP
      - optional:nacos:jwt-config.yml?group=DEFAULT_GROUP
      - optional:nacos:server-config.yml?group=DEFAULT_GROUP
      - optional:nacos:minio-config.yml?group=DEFAULT_GROUP
  
  # 本地默认配置（当 Nacos 配置不可用时使用）
  datasource:
    url: jdbc:mysql://localhost:3306/student_db?useSSL=false&serverTimezone=UTC&characterEncoding=utf8&allowPublicKeyRetrieval=true&useUnicode=true
    username: root
    password: 123456
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
  
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQL8Dialect
        format_sql: true
  
  redis:
    host: localhost
    port: 6379
    password: 
    timeout: 2000ms
    database: 0
    lettuce:
      pool:
        max-active: 8
        max-idle: 8
        min-idle: 0
        max-wait: -1ms

jwt:
  secret: your-secret-key-here-change-it-in-production-environment-very-important
  expiration: 604800000  # 7天
  refresh-expiration: 2592000000  # 30天

server:
  port: 8080
  servlet:
    context-path: /api
  compression:
    enabled: true
    min-response-size: 1024
  # 禁用 Spring Boot 自动配置的静态资源处理
  # 这样 Controller 能优先处理所有请求
  error:
    whitelabel:
      enabled: false

logging:
  level:
    root: INFO
    com.example.student: DEBUG
    org.springframework.security: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"

# 上传配置
upload:
  path: ./uploads
  max-file-size: 10485760  # 10MB
  allowed-extensions: jpg,jpeg,png,gif,pdf,doc,docx,xlsx,xls

# 登录配置
login:
  max-attempts: 5  # 最大登录尝试次数
  lock-duration-minutes: 15  # 锁定持续时间（分钟）

# Minio 对象存储配置
minio:
  enabled: true
  endpoint: http://localhost:9000
  access-key: admin
  secret-key: password123
  bucket: student-management
  use-path-style: true
  use-https: false

# RabbitMQ 消息队列配置
rabbit-mq:
  enabled: true
  host: localhost
  port: 5672
  username: guest
  password: guest
  virtual-host: /
  connection-timeout: 10000ms
